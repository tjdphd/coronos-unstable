\begin{tikzpicture}[scale=2.0, >=stealth']
%
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ %
% ~ coordinates ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ %
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ %
%
% ~ for rank 0 Grid A (specification of A, J) ~ %
%
\coordinate  (g0a0l) at (0.000cm,0.125cm);
\coordinate  (g0a0h) at ($(g0a0l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g0a1l) at ($(g0a0l) + (0.5cm, 0.0cm)$);
\coordinate  (g0a1h) at ($(g0a1l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g0a2l) at ($(g0a1l) + (0.5cm, 0.0cm)$);
\coordinate  (g0a2h) at ($(g0a2l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g0a3l) at ($(g0a2l) + (0.5cm, 0.0cm)$);
\coordinate  (g0a3h) at ($(g0a3l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g0a4l) at ($(g0a3l) + (0.5cm, 0.0cm)$);
\coordinate  (g0a4h) at ($(g0a4l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g0a5l) at ($(g0a4l) + (0.5cm, 0.0cm)$);
\coordinate  (g0a5h) at ($(g0a5l) + (0.0cm, 3.0cm)$);
%
% ~ for rank 0 Grid B (specification of phi, Omega) ~ %
%
\coordinate  (g0b0l) at (0.250cm, 0.000cm);
\coordinate  (g0b0h) at ($(g0b0l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g0b1l) at ($(g0b0l) + (0.5cm, 0.0cm)$);
\coordinate  (g0b1h) at ($(g0b1l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g0b2l) at ($(g0b1l) + (0.5cm, 0.0cm)$);
\coordinate  (g0b2h) at ($(g0b2l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g0b3l) at ($(g0b2l) + (0.5cm, 0.0cm)$);
\coordinate  (g0b3h) at ($(g0b3l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g0b4l) at ($(g0b3l) + (0.5cm, 0.0cm)$);
\coordinate  (g0b4h) at ($(g0b4l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g0b5l) at ($(g0b4l) + (0.5cm, 0.0cm)$);
\coordinate  (g0b5h) at ($(g0b5l) + (0.0cm, 3.0cm)$);
%
% ~ for rank 1 Grid A (specification of A, J) ~ %
%
\coordinate  (g1a0l) at (3.500cm,0.125cm);
\coordinate  (g1a0h) at ($(g1a0l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g1a1l) at ($(g1a0l) + (0.5cm, 0.0cm)$);
\coordinate  (g1a1h) at ($(g1a1l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g1a2l) at ($(g1a1l) + (0.5cm, 0.0cm)$);
\coordinate  (g1a2h) at ($(g1a2l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g1a3l) at ($(g1a2l) + (0.5cm, 0.0cm)$);
\coordinate  (g1a3h) at ($(g1a3l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g1a4l) at ($(g1a3l) + (0.5cm, 0.0cm)$);
\coordinate  (g1a4h) at ($(g1a4l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g1a5l) at ($(g1a4l) + (0.5cm, 0.0cm)$);
\coordinate  (g1a5h) at ($(g1a5l) + (0.0cm, 3.0cm)$);
%
% ~ for rank 1 Grid B (specification of phi, Omega) ~ %
%
\coordinate  (g1b0l) at (3.750cm, 0.000cm);
\coordinate  (g1b0h) at ($(g1b0l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g1b1l) at ($(g1b0l) + (0.5cm, 0.0cm)$);
\coordinate  (g1b1h) at ($(g1b1l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g1b2l) at ($(g1b1l) + (0.5cm, 0.0cm)$);
\coordinate  (g1b2h) at ($(g1b2l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g1b3l) at ($(g1b2l) + (0.5cm, 0.0cm)$);
\coordinate  (g1b3h) at ($(g1b3l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g1b4l) at ($(g1b3l) + (0.5cm, 0.0cm)$);
\coordinate  (g1b4h) at ($(g1b4l) + (0.0cm, 3.0cm)$);
%
\coordinate  (g1b5l) at ($(g1b4l) + (0.5cm, 0.0cm)$);
\coordinate  (g1b5h) at ($(g1b5l) + (0.0cm, 3.0cm)$);
%
% ~ for rank N Grid A (specification of A, J) ~ %
%
\coordinate  (gna0l) at (10.500cm,0.125cm);
\coordinate  (gna0h) at ($(gna0l) + (0.0cm, 3.0cm)$);
%
\coordinate  (gna1l) at ($(gna0l) + (0.5cm, 0.0cm)$);
\coordinate  (gna1h) at ($(gna1l) + (0.0cm, 3.0cm)$);
%
\coordinate  (gna2l) at ($(gna1l) + (0.5cm, 0.0cm)$);
\coordinate  (gna2h) at ($(gna2l) + (0.0cm, 3.0cm)$);
%
\coordinate  (gna3l) at ($(gna2l) + (0.5cm, 0.0cm)$);
\coordinate  (gna3h) at ($(gna3l) + (0.0cm, 3.0cm)$);
%
\coordinate  (gna4l) at ($(gna3l) + (0.5cm, 0.0cm)$);
\coordinate  (gna4h) at ($(gna4l) + (0.0cm, 3.0cm)$);
%
\coordinate  (gna5l) at ($(gna4l) + (0.5cm, 0.0cm)$);
\coordinate  (gna5h) at ($(gna5l) + (0.0cm, 3.0cm)$);
%
% ~ for rank N Grid B (specification of phi, Omega) ~ %
%
\coordinate  (gnb0l) at (10.750cm, 0.000cm);
\coordinate  (gnb0h) at ($(gnb0l) + (0.0cm, 3.0cm)$);
%
\coordinate  (gnb1l) at ($(gnb0l) + (0.5cm, 0.0cm)$);
\coordinate  (gnb1h) at ($(gnb1l) + (0.0cm, 3.0cm)$);
%
\coordinate  (gnb2l) at ($(gnb1l) + (0.5cm, 0.0cm)$);
\coordinate  (gnb2h) at ($(gnb2l) + (0.0cm, 3.0cm)$);
%
\coordinate  (gnb3l) at ($(gnb2l) + (0.5cm, 0.0cm)$);
\coordinate  (gnb3h) at ($(gnb3l) + (0.0cm, 3.0cm)$);
%
\coordinate  (gnb4l) at ($(gnb3l) + (0.5cm, 0.0cm)$);
\coordinate  (gnb4h) at ($(gnb4l) + (0.0cm, 3.0cm)$);
%
\coordinate  (gnb5l) at ($(gnb4l) + (0.5cm, 0.0cm)$);
\coordinate  (gnb5h) at ($(gnb5l) + (0.0cm, 3.0cm)$);
%
% ~ for passing atop down to previous rank           ~ %
%
\coordinate  (pas)   at ($(g0a5h) + (0.0cm,0.5cm)$);
\coordinate  (pau)   at ($(pas)   + (0.0cm,0.2cm)$);
\coordinate  (par)   at ($(g1a1h) + (0.0cm,0.7cm)$);
\coordinate  (pad)   at ($(par)   - (0.0cm,0.2cm)$);
%
\coordinate  (par1)   at ($(gna1h) + (0.0cm,0.5cm)$);
\coordinate  (pau1)   at ($(par1)  + (0.0cm,0.2cm)$);
\coordinate  (pam1)   at ($(pau1)  - (0.8cm,0.0cm)$);
\coordinate  (pas1)   at ($(pam1)  - (0.8cm,0.0cm)$);
%
% ~ for passing pbot up to next rank                ~ %
%
\coordinate  (pps)   at ($(g0b4l) - (0.0cm,0.5cm)$);
\coordinate  (ppu)   at ($(pps)   - (0.0cm,0.2cm)$);
\coordinate  (ppr)   at ($(g1b0l) - (0.0cm,0.7cm)$);
\coordinate  (ppd)   at ($(ppr)   + (0.0cm,0.2cm)$);
%
\coordinate  (pps1)   at ($(g1b4l) - (0.0cm,0.5cm)$);
\coordinate  (ppu1)   at ($(pps1)  - (0.0cm,0.2cm)$);
\coordinate  (ppm1)   at ($(ppu1)  + (0.8cm,0.0cm)$);
\coordinate  (ppr1)   at ($(ppm1)  + (0.8cm,0.0cm)$);
%
% ~ for labeling rank of stack                      ~ %
%
\coordinate (s0lab)  at (0.0cm,-1.0cm);
\coordinate (s1lab)  at ($(g1b0l) + (-0.25cm,-1.0cm)$);
\coordinate (snlab)  at ($(gnb0l) + (-0.25cm,-1.0cm)$);
%
% ~ for specifying column length                    ~ %
%
\coordinate (hshll)  at ($(g0b0h) + (0.0cm, 0.8cm)$);
\coordinate (hshhl)  at ($(hshll) + (0.0cm, 0.8cm)$);
%
\coordinate (hshlr)  at ($(gnb4h) + (0.0cm, 0.8cm)$);
\coordinate (hshhr)  at ($(hshlr) + (0.0cm, 0.8cm)$);
%
\coordinate (lwarl)  at ($(hshll) + (0.0cm, 0.6cm)$); 
\coordinate (rwarr)  at ($(hshlr) + (0.0cm, 0.6cm)$); 
%
% ~ for showing Cartesian axes                      ~ %
%
\coordinate (orig)   at ($(g1b5l) + (2.0cm, 1.85cm)$);

% ~ for indicating field specifications             ~ %
%
\coordinate (gridal) at ($(g1b5l)    + (2.125cm, 1.125cm)$);
\coordinate (gridar) at ($(gridal)   + (1.0cm, 0.000cm)$);
%
\coordinate (gridbl) at ($(g1b5l)    + (2.125cm, 0.75cm)$);
\coordinate (gridbr) at ($(gridbl)   + (1.0cm, 0.00cm)$);
%
\coordinate (gridbcl) at ($(g1b5l)   + (2.125cm, 0.375cm)$);
\coordinate (gridbcr) at ($(gridbcl) + (1.0cm, 0.00cm)$);

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ %
% ~ grid layers ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ %
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ %
%
% ~ for rank 0 Grid A (specification of A, J) ~ %
%
\draw[         gray, dashed] (g0a0l) -- (g0a0h) node [ yshift = 0.2cm ] { $0$ };
\draw[very thick,blue!65!black, dashed] (g0a1l) -- (g0a1h) node [ yshift = 0.2cm ] { $1$ };
\draw[very thick,blue!65!black, dashed] (g0a2l) -- (g0a2h) node [ yshift = 0.2cm ] { $2$ };
\draw[very thick,blue!65!black, dashed] (g0a3l) -- (g0a3h) node [ yshift = 0.2cm ] { $3$ };
\draw[very thick,blue!65!black, dashed] (g0a4l) -- (g0a4h) node [ yshift = 0.2cm ] { $4$ };
\draw[blue!65!black, dashed] (g0a5l) -- (g0a5h) node [ yshift = 0.2cm ] { $5$ };
%
% ~ for rank 0 Grid B (specification of phi, Omega) ~ %
%
\draw[red!65!black] (g0b0h) -- (g0b0l) node [ yshift = -0.2cm ,green!65!black] { $0$ };
\draw[very thick,green!65!black] (g0b1h) -- (g0b1l) node [ yshift = -0.2cm ]   { $1$ };
\draw[very thick,green!65!black] (g0b2h) -- (g0b2l) node [ yshift = -0.2cm ]   { $2$ };
\draw[very thick,green!65!black] (g0b3h) -- (g0b3l) node [ yshift = -0.2cm ]   { $3$ };
\draw[very thick,green!65!black] (g0b4h) -- (g0b4l) node [ yshift = -0.2cm ]   { $4$ };
\draw[gray] (g0b5h) -- (g0b5l) node [ yshift = -0.2cm ] { $5$ };
%
% ~ for rank 1 Grid A (specification of A, J) ~ %
%
\draw[gray, dashed] (g1a0l) -- (g1a0h) node [ yshift = 0.2cm ] { $0$ };
\draw[very thick,blue!65!black, dashed] (g1a1l) -- (g1a1h) node [ yshift = 0.2cm ] { $1$ };
\draw[very thick,blue!65!black, dashed] (g1a2l) -- (g1a2h) node [ yshift = 0.2cm ] { $2$ };
\draw[very thick,blue!65!black, dashed] (g1a3l) -- (g1a3h) node [ yshift = 0.2cm ] { $3$ };
\draw[very thick,blue!65!black, dashed] (g1a4l) -- (g1a4h) node [ yshift = 0.2cm ] { $4$ };
\draw[blue!65!black, dashed] (g1a5l) -- (g1a5h) node [ yshift = 0.2cm ] { $5$ };
%
% ~ for rank 1 Grid B (specification of phi, Omega) ~ %
%
\draw[green!65!black] (g1b0h) -- (g1b0l) node [ yshift = -0.2cm ] { $0$ };
\draw[very thick,green!65!black] (g1b1h) -- (g1b1l) node [ yshift = -0.2cm ] { $1$ };
\draw[very thick,green!65!black] (g1b2h) -- (g1b2l) node [ yshift = -0.2cm ] { $2$ };
\draw[very thick,green!65!black] (g1b3h) -- (g1b3l) node [ yshift = -0.2cm ] { $3$ };
\draw[very thick,green!65!black] (g1b4h) -- (g1b4l) node [ yshift = -0.2cm ] { $4$ };
\draw[gray] (g1b5h) -- (g1b5l) node [ yshift = -0.2cm ] { $5$ };
%
\draw[dotted             ] ($(g1b5l)+(0.2cm, 0.0cm)$) -- ($(gna0l)-( 0.2cm,0.125cm)$);
\draw[dotted             ] ($(g1b5l)+(0.2cm, 1.5cm)$) -- ($(gna0l)+(-0.2cm,1.375cm)$);
\draw[dotted             ] ($(g1b5l)+(0.2cm, 3.0cm)$) -- ($(gna0l)+(-0.2cm,2.875cm)$);
%
% ~ for rank n Grid A (specification of A, J) ~ %
%
\draw[gray, dashed] (gna0l) -- (gna0h) node [ yshift = 0.2cm ] { $0$ };
\draw[very thick,blue!65!black, dashed] (gna1l) -- (gna1h) node [ yshift = 0.2cm ] { $1$ };
\draw[very thick,blue!65!black, dashed] (gna2l) -- (gna2h) node [ yshift = 0.2cm ] { $2$ };
\draw[very thick,blue!65!black, dashed] (gna3l) -- (gna3h) node [ yshift = 0.2cm ] { $3$ };
\draw[very thick,blue!65!black, dashed] (gna4l) -- (gna4h) node [ yshift = 0.2cm ] { $4$ };
\draw[blue!65!black, dashed] (gna5l) -- (gna5h) node [ yshift = 0.2cm ] { $5$ };
%
% ~ for rank n Grid B (specification of phi, Omega) ~ %
%
\draw[green!65!black] (gnb0h) -- (gnb0l) node [ yshift = -0.2cm ] { $0$ };
\draw[very thick,green!65!black] (gnb1h) -- (gnb1l) node [ yshift = -0.2cm ] { $1$ };
\draw[very thick,green!65!black] (gnb2h) -- (gnb2l) node [ yshift = -0.2cm ] { $2$ };
\draw[very thick,green!65!black] (gnb3h) -- (gnb3l) node [ yshift = -0.2cm ] { $3$ };
\draw[very thick,  red!65!black] (gnb4h) -- (gnb4l) node [ yshift = -0.2cm, green!65!black]{ $4$ };
\draw[gray] (gnb5h) -- (gnb5l) node [ yshift = -0.2cm ] { $5$ };
%
% ~ for passing atop down to previous rank          ~ %
%
\draw[<-,blue!65!black,  postaction={reverse mid arrow=blue!65!black}] (pas) -- (pau) 
%                                  -- (par) node [black, xshift=-0.5cm, yshift=0.3cm] {\Large $A$} -- (pad);
                                   -- (par) node [black, xshift=-1.0cm, yshift=0.3cm] {\Large $A$, $\hfield$, $V_z$} -- (pad);
\draw[->,green!65!black, postaction={        mid arrow=green!65!black}] (pps) -- (ppu) 
%node [black, xshift=0.6cm, yshift=-0.4cm] {\Large $\Omega$}-- (ppr) -- (ppd);
 node [black, xshift=0.6cm, yshift=-0.4cm] {\Large $\Omega$, $Z$}-- (ppr) -- (ppd);
\draw[->,green!65!black] (pps1) -- (ppu1) -- (ppm1);
\draw[dotted, green!65!black] (ppm1) -- (ppr1);
\draw[->,blue!65!black] (par1) -- (pau1) -- (pam1);
\draw[dotted,blue!65!black] (pam1) -- (pas1);
%
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ %
% ~ grid labels ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ %
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ %
%
% ~ for rank of stack                               ~ %
%
\filldraw[white] (s0lab) circle (0.0pt) node  [black,xshift = 0.6cm] {\Large process $0$};
\filldraw[white] (s1lab) circle (0.0pt) node  [black,xshift = 0.6cm] {\Large process $1$};
\filldraw[white] (snlab) circle (0.0pt) node  [black,xshift = 0.6cm] {\Large process $N$};
%
% ~ for specifying column length                    ~ %
%
\draw[] (hshll) -- (hshhl);
\draw[] (hshlr) -- (hshhr);
\draw[<-] let \p1 = (lwarl),
          \p2 = (rwarr) in
          (lwarl) -- ($(lwarl) + (0.475*\x2, 0.0cm)$) node [xshift = 0.325cm] {\Large $L$}; 
\draw[<-] let \p1 = (lwarl),
          \p2 = (rwarr) in
(rwarr) -- ($(rwarr) - (0.475*\x2, 0.0cm)$);
%
% ~ for showing Cartesian axes                      ~ %
%
\filldraw[black] (orig) circle (0.5pt);
    \draw[black] (orig) circle (2.0pt) node [xshift=-0.3cm, yshift=-0.3cm ] {\Large $y$};
    \draw[->]    ($(orig)+(2.0pt,0.0cm)$) -- +(0.7cm,0.0cm) node [xshift=0.2cm] {\Large $z$};
    \draw[->]    ($(orig)+(0.0cm,2.0pt)$) -- +(0.0cm,0.7cm) node [yshift=0.2cm] {\Large $x$};
%
% ~ for indicating field specifications             ~ %
%
\draw[very thick, blue!65!black,dashed]  (gridar) -- (gridal)  node [xshift = -1.750cm, black]  {\Large $A$, $J$, $\hfield$, $V_z$ };
%\draw[very thick, blue!65!black,dashed]  (gridar) -- (gridal)  node [xshift = -1.250cm, black]  {\Large $A$, $J$ };
%\draw[very thick, green!65!black]        (gridbr) -- (gridbl)  node [xshift = -1.250cm, black]  {\Large $\phi$, $\Omega$};
\draw[very thick, green!65!black]        (gridbr) -- (gridbl)  node [xshift = -1.250cm, black]  {\Large $\phi$, $\Omega$, $Z$ };
\draw[very thick, red!65!black]         (gridbcr) -- (gridbcl) node [xshift = -1.750cm, black]  {\Large B.C.'s ($\Omega$, $Z$) };
%\draw[very thick, red!65!black]         (gridbcr) -- (gridbcl) node [xshift = -1.750cm, black]  {\Large B.C.'s ($\Omega$) };
\end{tikzpicture}
